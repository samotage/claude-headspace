# Claude Headspace Configuration
# Environment variables override these values (e.g., FLASK_SERVER_PORT=8080)

server:
  host: "0.0.0.0"
  port: 5055
  debug: true

logging:
  level: "INFO"
  file: "logs/app.log"

# Database Configuration
# DATABASE_URL env var takes precedence if set
# Individual fields can be overridden with DATABASE_HOST, DATABASE_PORT, etc.
database:
  host: "localhost"
  port: 5432
  name: "claude_headspace"
  user: "samotage"
  password: ""
  pool_size: 10
  pool_timeout: 30

# Claude Code integration
claude:
  projects_path: "~/.claude/projects"

# File watcher for monitoring Claude Code session files
file_watcher:
  polling_interval: 2  # seconds (fallback mode)
  reconciliation_interval: 60  # seconds (hooks-active mode)
  inactivity_timeout: 5400  # 90 minutes in seconds
  debounce_interval: 0.5  # seconds

# Event system for persisting events to Postgres
event_system:
  write_retry_attempts: 3
  write_retry_delay_ms: 100
  max_restarts_per_minute: 5
  shutdown_timeout_seconds: 2

# Server-Sent Events (SSE) for real-time updates
sse:
  heartbeat_interval_seconds: 30
  max_connections: 100
  connection_timeout_seconds: 60
  retry_after_seconds: 5

# OpenRouter LLM inference configuration
# OPENROUTER_API_KEY env var required for authentication
openrouter:
  base_url: "https://openrouter.ai/api/v1"
  timeout: 30
  models:
    turn: "anthropic/claude-3-5-haiku-20241022"
    task: "anthropic/claude-3-5-haiku-20241022"
    project: "anthropic/claude-3-5-sonnet-20241022"
    objective: "anthropic/claude-3-5-sonnet-20241022"
  rate_limits:
    calls_per_minute: 30
    tokens_per_minute: 50000
  cache:
    enabled: true
    ttl_seconds: 300  # 5 minutes
  retry:
    max_attempts: 3
    base_delay_seconds: 1.0
    max_delay_seconds: 30.0
  pricing:
    "anthropic/claude-3-5-haiku-20241022":
      input_per_million: 1.0
      output_per_million: 5.0
    "anthropic/claude-3-5-sonnet-20241022":
      input_per_million: 3.0
      output_per_million: 15.0

# Dashboard display settings
dashboard:
  stale_processing_seconds: 600  # Agents PROCESSING longer than this shown as "Timed out"
  active_timeout_minutes: 5      # Agent considered active if seen within this window
