<article class="bg-elevated rounded-lg border border-border overflow-hidden focus-target transition-shadow duration-300"
         data-agent-id="{{ agent.id }}"
         data-state="{{ agent.state.name }}"
         aria-labelledby="agent-{{ agent.id }}-heading">
  <div class="card-editor">
    <!-- 01: Header row -->
    <div class="card-line">
      <span class="line-num">01</span>
      <div class="line-content flex items-center justify-between">
        <div class="flex flex-wrap items-center gap-2">
          {% if agent.is_active %}
            <span class="status-badge px-2 py-0.5 text-xs font-medium rounded bg-green/20 text-green"
                  role="status">ACTIVE</span>
          {% else %}
            <span class="status-badge px-2 py-0.5 text-xs font-medium rounded bg-muted/20 text-muted"
                  role="status">IDLE</span>
          {% endif %}
          <h3 id="agent-{{ agent.id }}-heading" class="text-cyan text-sm font-mono truncate max-w-[140px] sm:max-w-none">#{{ agent.session_uuid }}</h3>
          <span class="uptime text-muted text-xs hidden sm:inline">up {{ agent.uptime }}</span>
        </div>
      </div>
    </div>
    <!-- 02: spacer -->
    <div class="card-line">
      <span class="line-num">02</span>
      <div class="line-content"></div>
    </div>
    <!-- 03: State strip (clickable - focuses iTerm) -->
    <div class="card-line">
      <span class="line-num">03</span>
      <div class="line-content">
        <div class="state-bar state-strip clickable"
             role="button" tabindex="0"
             aria-label="Focus iTerm: {{ agent.state_info.label }}"
             title="Click to focus this agent's iTerm window"
             onclick="window.FocusAPI && window.FocusAPI.focusAgent({{ agent.id }})"
             onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();window.FocusAPI && window.FocusAPI.focusAgent({{ agent.id }});}">
          <span class="state-label">{{ agent.state_info.label }}</span>
        </div>
      </div>
    </div>
    <!-- 04: spacer -->
    <div class="card-line">
      <span class="line-num">04</span>
      <div class="line-content"></div>
    </div>
    <!-- 05: Task summary -->
    <div class="card-line">
      <span class="line-num">05</span>
      <div class="line-content">
        <p class="task-summary text-secondary text-sm italic">{{ agent.task_summary }}</p>
      </div>
    </div>
  </div>
  <!-- Priority footer -->
  <div class="flex items-center gap-3 px-3 py-2 border-t border-border">
    <span class="px-2 py-0.5 text-xs font-mono rounded border border-border text-secondary">{{ agent.priority }}</span>
    <span class="text-muted text-xs italic">// {{ agent.task_summary[:50] if agent.task_summary else 'Priority score' }}</span>
  </div>
</article>
