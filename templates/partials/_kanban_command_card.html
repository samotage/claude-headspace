<!-- Kanban command card: represents an active command in a state column -->
<article class="bg-elevated rounded-lg border border-border overflow-hidden focus-target transition-shadow duration-300"
         data-agent-id="{{ item.agent.id }}"
         data-state="{{ item.state }}"
         aria-label="Command for agent {{ item.agent.hero_chars }}">
    <div class="p-3">
        <!-- Agent identity + state -->
        <div class="flex items-baseline justify-between mb-2">
            <div class="flex items-baseline gap-2">
                <span class="flex items-baseline gap-0.5">
                    <span class="agent-hero text-sm">{{ item.agent.hero_chars }}</span><span class="agent-hero-trail">{{ item.agent.hero_trail }}</span>
                </span>
            </div>
            <div class="flex items-baseline gap-2">
                <span class="uptime text-muted text-xs">{{ item.agent.uptime }}</span>
                {% if item.agent.is_active %}
                    <span class="status-badge px-1.5 py-0.5 text-xs font-medium rounded bg-green/20 text-green">ACTIVE</span>
                {% endif %}
            </div>
        </div>
        <!-- State strip (clickable) -->
        <div class="state-bar state-strip clickable mb-2"
             role="button" tabindex="0"
             aria-label="Focus iTerm: {{ item.agent.state_info.label }}"
             title="Click to focus this agent's iTerm window"
             onclick="window.FocusAPI && window.FocusAPI.focusAgent({{ item.agent.id }})"
             onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();window.FocusAPI && window.FocusAPI.focusAgent({{ item.agent.id }});}">
            <span class="state-label">{{ item.agent.state_info.label }}</span>
        </div>
        <!-- Task instruction -->
        {% if item.command_instruction %}
            <p class="task-instruction text-primary text-sm font-medium mb-1">{{ item.command_instruction }}</p>
        {% endif %}
        <!-- Command summary -->
        {% if item.command_summary %}
            <p class="task-summary text-secondary text-xs italic">{{ item.command_summary }}</p>
        {% endif %}
    </div>
    <!-- Priority footer -->
    <div class="flex items-center gap-2 px-3 py-1.5 border-t border-border">
        <span class="px-1.5 py-0.5 text-xs font-mono rounded border border-border text-secondary">{{ item.agent.priority }}</span>
        <span class="text-muted text-xs italic truncate">// {{ item.agent.priority_reason[:40] if item.agent.priority_reason else '' }}</span>
    </div>
</article>
